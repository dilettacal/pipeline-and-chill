graph TB
    %% Trigger
    TRIGGER["ğŸš€ Push/PR Trigger"]

    %% Parallel Jobs
    subgraph "Parallel Test Execution"
        UNIT["ğŸ§ª Unit Tests<br/>Fast, Isolated"]
        STREAM["âš¡ Stream Tests<br/>Kafka Integration"]
        BATCH["ğŸ“Š Batch Tests<br/>PostgreSQL Integration"]
        CONTRACT["ğŸ“‹ Contract Tests<br/>Schema Validation"]
        SMOKE["ğŸ’¨ Smoke Tests<br/>CLI Validation"]
        QUALITY["âœ… Quality Checks<br/>Linting & Formatting"]
    end

    %% Integration Tests
    subgraph "Integration Tests"
        STREAM_INT["âš¡ Stream Integration<br/>Testcontainers + Kafka"]
        BATCH_INT["ğŸ“Š Batch Integration<br/>Testcontainers + PostgreSQL"]
    end

    %% Infrastructure
    subgraph "Infrastructure"
        DOCKER["ğŸ³ Docker<br/>Container Runtime"]
        TESTCONTAINERS["ğŸ§ª Testcontainers<br/>Real Services"]
        REDPANDA["âš¡ Redpanda<br/>Kafka Alternative"]
    end

    %% Quality Gates
    subgraph "Quality Gates"
        PRECOMMIT["âœ… pre-commit<br/>Code Quality"]
        BLACK["ğŸ¨ Black<br/>Code Formatting"]
        ISORT["ğŸ“¦ isort<br/>Import Sorting"]
        FLAKE8["ğŸ” flake8<br/>Linting"]
    end

    %% Results
    SUCCESS["âœ… All Tests Pass"]
    FAILURE["âŒ Test Failure"]
    DEPLOY["ğŸš€ Ready for Deployment"]

    %% Flow
    TRIGGER --> UNIT
    TRIGGER --> STREAM
    TRIGGER --> BATCH
    TRIGGER --> CONTRACT
    TRIGGER --> SMOKE
    TRIGGER --> QUALITY

    UNIT --> STREAM_INT
    STREAM --> STREAM_INT
    BATCH --> BATCH_INT

    STREAM_INT --> DOCKER
    BATCH_INT --> DOCKER
    DOCKER --> TESTCONTAINERS
    TESTCONTAINERS --> REDPANDA

    QUALITY --> PRECOMMIT
    PRECOMMIT --> BLACK
    PRECOMMIT --> ISORT
    PRECOMMIT --> FLAKE8

    STREAM_INT --> SUCCESS
    BATCH_INT --> SUCCESS
    CONTRACT --> SUCCESS
    SMOKE --> SUCCESS
    PRECOMMIT --> SUCCESS

    SUCCESS --> DEPLOY
    FAILURE --> TRIGGER

    %% Styling
    classDef trigger fill:#ffebee,stroke:#c62828,stroke-width:3px,color:#000
    classDef test fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#000
    classDef integration fill:#e3f2fd,stroke:#1565c0,stroke-width:2px,color:#000
    classDef infrastructure fill:#fff3e0,stroke:#ef6c00,stroke-width:2px,color:#000
    classDef quality fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px,color:#000
    classDef result fill:#e0f2f1,stroke:#00695c,stroke-width:3px,color:#000

    class TRIGGER trigger
    class UNIT,STREAM,BATCH,CONTRACT,SMOKE test
    class STREAM_INT,BATCH_INT integration
    class DOCKER,TESTCONTAINERS,REDPANDA infrastructure
    class QUALITY,PRECOMMIT,BLACK,ISORT,FLAKE8 quality
    class SUCCESS,FAILURE,DEPLOY result
